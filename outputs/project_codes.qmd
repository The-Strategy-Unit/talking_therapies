---
title: "NHS Talking Therapies"
subtitle: "Lookup project codes"
author: "Craig Parylo"
date: today

title-block-banner: '#151412'
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    embed-resources: true
    fig-format: png
    fig-width: 10
    fig-height: 3
    fig-dpi: 600
    default-image-extension: svg
    lightbox: true
    editor: visual
    favicon: "favicon.ico"
    include-in-header:
      text: |
        <link rel="icon" type="image/x-icon" href="favicon.ico">
brand: _brand.yml
css: styles.css
---

# Projects

```{r}
#| label: setup
#| context: setup

# load in utility functions
source(here::here('scripts', 'utility_functions.R'))

# load in matching variables
df <- get_matching_variables()

# extract some details for display

df |>
  # summarise the data
  dplyr::summarise(
    earliest_data = min(calc_month, na.rm = TRUE) |> zoo::as.Date(),
    latest_data = max(calc_month, na.rm = TRUE) |> zoo::as.Date(),
    average_discharges = median(o1_denom_discharges_count, na.rm = TRUE),
    .by = c(ods_code, name)
  ) |>
  # arrange
  dplyr::arrange(ods_code, name) |>
  # display in an interactive table
  reactable::reactable(
    searchable = TRUE,
    sortable = TRUE,
    resizable = TRUE,
    defaultColDef = reactable::colDef(minWidth = 50),
    columns = list(
      ods_code = reactable::colDef(name = "ODS code"),
      name = reactable::colDef(name = "Organisation name", minWidth = 150),
      earliest_data = reactable::colDef(name = "Earliest data"),
      latest_data = reactable::colDef(name = "Latest data"),
      average_discharges = reactable::colDef(
        name = "Average number of discharges"
      )
    )
  )
```
